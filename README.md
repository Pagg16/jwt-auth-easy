# JWT Auth Easy

–ü—Ä–æ—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ JWT (JSON Web Token) –¥–ª—è Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Express.js, MongoDB (Mongoose) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–æ—Ç–æ–≤—ã–µ middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
jwt-auth-easy/
‚îú‚îÄ‚îÄ middleware/
‚îÇ ‚îú‚îÄ‚îÄ authMiddleware.js # Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ JWT —Ç–æ–∫–µ–Ω–∞
‚îÇ ‚îî‚îÄ‚îÄ roleMiddleware.js # Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ models/
‚îÇ ‚îú‚îÄ‚îÄ User.js # –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ ‚îî‚îÄ‚îÄ Role.js # –ú–æ–¥–µ–ª—å —Ä–æ–ª–µ–π
‚îú‚îÄ‚îÄ config.js # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á)
‚îú‚îÄ‚îÄ authController.js # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –ª–æ–≥–∏–Ω–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îú‚îÄ‚îÄ authRouter.js # –†–æ—É—Ç–µ—Ä –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ index.js # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ package.json # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞

```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
git clone <repository-url>
cd jwt-auth-easy
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –≤ –∫–æ–¥–µ):

```env
PORT=5000
DB_URI=mongodb://localhost:27017/auth
```

### 3. –ó–∞–ø—É—Å–∫ MongoDB

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MongoDB –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ URI –≤–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ `DB_URI`.

### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
npm start
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:5000` (–∏–ª–∏ –¥—Ä—É–≥–æ–º —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–æ—Ä—Ç–µ).

## üìå API Endpoints

### üîê **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**

#### `POST /auth/registration`

–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "username": "testuser",
  "password": "password123"
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**

- `username` ‚Äî –Ω–µ –ø—É—Å—Ç–æ–µ, –æ—Ç 4 –¥–æ 15 —Å–∏–º–≤–æ–ª–æ–≤.
- `password` ‚Äî –Ω–µ –∫–æ—Ä–æ—á–µ 4 —Å–∏–º–≤–æ–ª–æ–≤.

**–û—Ç–≤–µ—Ç:**

- –£—Å–ø–µ—Ö: `"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"`
- –û—à–∏–±–∫–∞: —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å –∫–æ–¥–æ–º 400.

---

#### `POST /auth/login`

–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "username": "testuser",
  "password": "password123"
}
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

---

### üë• **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**

#### `GET /auth/users`

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–ó–∞–≥–æ–ª–æ–≤–æ–∫:**

```http
Authorization: Bearer <JWT_TOKEN>
```

**–î–æ—Å—Ç—É–ø:** –¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—å—é `ADMIN`.

**–û—Ç–≤–µ—Ç:**

```json
[
  {
    "_id": "...",
    "username": "admin",
    "roles": ["ADMIN"]
  }
]
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ–ª–µ–π

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ä–æ–ª—å `USER`. –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª–∏ `ADMIN` –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ MongoDB:

```javascript
db.roles.insertOne({ value: "ADMIN" });
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Mongoose –≤ –∫–æ–¥–µ:

```javascript
const Role = require("./models/Role");
new Role({ value: "ADMIN" }).save();
```

## üõ°Ô∏è Middleware

### `authMiddleware`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization`. –î–æ–±–∞–≤–ª—è–µ—Ç `req.user` —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞.

### `roleMiddleware(roles)`

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Ä–æ–ª–µ–π. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–æ—É—Ç–∞—Ö:**

```javascript
router.get(
  "/users",
  authMiddleware,
  roleMiddleware(["ADMIN"]),
  controller.getUsers
);
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª `config.js` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT:

```javascript
module.exports = {
  secret: "SECRET", // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π —Å–µ–∫—Ä–µ—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
};
```

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- express
- mongoose
- jsonwebtoken
- bcryptjs
- express-validator

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```bash
npm install express mongoose jsonwebtoken bcryptjs express-validator
```

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:

```bash
curl -X POST http://localhost:5000/auth/registration \
  -H "Content-Type: application/json" \
  -d '{"username":"newuser","password":"pass123"}'
```

### –õ–æ–≥–∏–Ω:

```bash
curl -X POST http://localhost:5000/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"newuser","password":"pass123"}'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥–ª—è –∞–¥–º–∏–Ω–∞):

```bash
curl -X GET http://localhost:5000/auth/users \
  -H "Authorization: Bearer <YOUR_TOKEN>"
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `bcryptjs`.
- JWT —Ç–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ 24 —á–∞—Å–∞.
- –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑–º–µ–Ω—ë–Ω –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å—Ä–µ–¥–µ.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

## üìù –ó–∞–º–µ—Ç–∫–∏

- –î–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä–æ–ª—å `USER`.
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–æ–±–∞–≤—å—Ç–µ —Ä–æ–ª—å `ADMIN` –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞–∑–Ω–∞—á—å—Ç–µ –µ—ë –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- –í —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB.

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–ü–∞–≤–µ–ª –ö—É–ª–µ–±–∏–Ω
